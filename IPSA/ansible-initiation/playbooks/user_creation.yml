- name: Cr√©er des utilisateurs
  hosts: localhost
  become: true
  vars:
    users:
      - name: user1
        password: "{{ lookup('env', 'password_user1') | password_hash('sha512') }}"
      - name: user2
        password: "{{ lookup('env', 'password_user2') | password_hash('sha512') }}"
      - name: user3
        password: "{{ lookup('env', 'password_user3') | password_hash('sha512') }}"
  tasks:
    - name: Ajouter plusieurs utilisateurs
      ansible.builtin.user:
        name: "{{ item.name }}"
        password: "{{ item.password }}"
        state: present
      loop: "{{ users }}"